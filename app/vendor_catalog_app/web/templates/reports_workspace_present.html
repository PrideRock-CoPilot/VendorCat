{% extends "base.html" %}
{% from "_reports_chart_macros.html" import render_chart %}
{% block content %}
<div class="section-header">
  <div>
    <h1>Presentation Mode</h1>
    <p>{{ board.board_name }} includes {{ widget_views|length }} widget{% if widget_views|length != 1 %}s{% endif %}.</p>
  </div>
  <div class="button-group">
    <a class="button-link subtle" href="/reports/workspace?board={{ board.board_id }}">Back To Designer</a>
    <a class="button-link subtle" href="/reports/workspace/boards/export?board={{ board.board_id }}">Export Board Bundle</a>
  </div>
</div>

<div class="grid grid-2 reports-present-grid">
  {% for widget in widget_views %}
  <section class="card section-divider reports-present-widget">
    <div class="section-header">
      <div>
        <h2>{{ widget.title }}</h2>
        <p class="muted">{{ widget.report_label }} | {{ widget.widget_type }} | {{ widget.view_mode }} | {{ widget.row_count }} rows</p>
      </div>
      <div class="button-group">
        <a class="button-link subtle" href="{{ widget.run_url }}" target="_blank" rel="noopener noreferrer">Open Runner</a>
      </div>
    </div>

    {% if widget.show_chart %}
      {% if widget.chart_rows %}
        {{ render_chart(widget.chart_kind, widget.chart_rows, widget.chart_line_path, widget.chart_line_points) }}
      {% else %}
      <p class="muted">No chartable rows for this widget.</p>
      {% endif %}
    {% endif %}

    {% if widget.show_table %}
    <div class="table-wrap table-scroll" style="margin-top:10px;">
      <table>
        <thead>
          <tr>
            {% for column in widget.preview_columns %}
            <th>{{ column }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in widget.preview_rows %}
          <tr>
            {% for column in widget.preview_columns %}
            <td>{{ row[column] }}</td>
            {% endfor %}
          </tr>
          {% else %}
          <tr><td colspan="{{ widget.preview_columns|length if widget.preview_columns else 1 }}">No preview rows.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}
  </section>
  {% endfor %}
</div>
{% endblock %}
