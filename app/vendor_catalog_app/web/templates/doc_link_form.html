{% macro render_doc_link_form(post_url, return_to, submit_label="Add Link") -%}
<form method="post" action="{{ post_url }}" class="grid grid-3" data-doc-link-form>
  <input type="hidden" name="return_to" value="{{ return_to }}">
  <label>SharePoint URL <span class="field-error">*</span>
    <input type="url" name="doc_url" placeholder="https://contoso.sharepoint.com/sites/vendor/docs/contract.docx" required data-doc-url>
    <small class="muted">Links only. VendorCat stores metadata and URL, not files.</small>
  </label>
  <label>Type <span class="field-error">*</span>
    <select name="doc_type" data-doc-type required>
      <option value="" disabled selected>Select type</option>
      {% for type in doc_types %}
      <option value="{{ type }}">{{ type }}</option>
      {% endfor %}
    </select>
  </label>
  <label>Title
    <input type="text" name="doc_title" maxlength="120" placeholder="e.g., Master Service Agreement">
  </label>
  <label>Owner <span class="field-error">*</span>
    <select name="owner" required data-doc-owner-select>
      <option value="">Select owner...</option>
      {% for owner_option in doc_owner_options %}
      <option value="{{ owner_option.login_identifier }}" {% if owner_option.login_identifier == user_principal %}selected{% endif %}>{{ owner_option.label }}</option>
      {% endfor %}
    </select>
    <small class="muted">Required for audit and compliance.</small>
  </label>
  <label>Tags
    <select name="tags" multiple size="4" data-doc-tags>
      {% for tag in doc_tag_options %}
      <option value="{{ tag }}">{{ tag }}</option>
      {% endfor %}
    </select>
    <small class="muted">Use Ctrl/Cmd to multi-select.</small>
  </label>
  <label>Additional Tags
    <input type="text" name="tag_new" placeholder="comma-separated, e.g., legal, renewal_q4" data-doc-tags-custom>
  </label>
  <label>Expiration Date
    <input type="date" name="expires_on">
  </label>
  {% if has_admin_rights %}
  <label>New Owner (Optional)
    <input type="text" name="owner_new" placeholder="email or network ID" data-doc-owner-input>
    <small class="muted">If provided, owner will be added during submit.</small>
  </label>
  <input type="hidden" name="allow_owner_create" value="1" data-allow-owner-create>
  {% endif %}
  <div><button type="submit">{{ submit_label }}</button></div>
</form>
{%- endmacro %}
