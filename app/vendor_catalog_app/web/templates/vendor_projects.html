{% extends "base.html" %}
{% block content %}
<div class="section-header">
  <div>
    <h1>{{ vendor_display_name }} Projects</h1>
    <p>Track implementation, POC, renewal, and related project activity.</p>
  </div>
  <div class="button-group">
    {% if can_edit and not locked_mode %}
    <a class="button-link" href="/vendors/{{ vendor_id }}/projects/new?return_to={{ return_to|urlencode }}">+ New Project</a>
    {% endif %}
    <a class="button-link subtle" href="/vendors/{{ vendor_id }}/summary?return_to={{ return_to|urlencode }}">Vendor Summary</a>
    <a class="button-link" href="{{ return_to }}">Back To List</a>
  </div>
</div>

<section class="metrics">
  <div class="metric"><span>Lifecycle</span><strong>{{ summary.lifecycle_state }}</strong></div>
  <div class="metric"><span>Risk Tier</span><strong>{{ summary.risk_tier }}</strong></div>
  <div class="metric"><span>Offerings</span><strong>{{ summary.offering_count|int }}</strong></div>
  <div class="metric"><span>Active Contracts</span><strong>{{ summary.active_contract_count|int }}</strong></div>
  <div class="metric"><span>Demos Selected</span><strong>{{ summary.demos_selected|int }}</strong></div>
  <div class="metric"><span>Demos Not Selected</span><strong>{{ summary.demos_not_selected|int }}</strong></div>
</section>

<section class="card section-nav-card">
  <div class="section-nav-links">
    {% for item in vendor_nav %}
    <a class="{% if item.active %}active{% endif %}" href="{{ item.url }}">{{ item.label }}</a>
    {% endfor %}
  </div>
</section>

<section class="card section-divider">
  <h2>Projects</h2>
  <table>
    <thead>
      <tr>
        <th>Project Name</th>
        <th>Status</th>
        <th>Start</th>
        <th>Target</th>
        <th>Owner</th>
        <th># Demos</th>
        <th>Last Activity</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
    {% for row in projects %}
    <tr>
      <td>{{ row.project_name }}</td>
      <td>{{ row.status }}</td>
      <td>{{ row.start_date }}</td>
      <td>{{ row.target_date }}</td>
      <td>{{ row.owner_principal }}</td>
      <td>{{ row.demo_count }}</td>
      <td>{{ row.last_activity_at }}</td>
      <td class="button-group">
        <a class="button-link subtle" href="{{ row._open_link }}">Open</a>
        {% if can_edit and not locked_mode %}
        <a class="button-link subtle" href="{{ row._edit_link }}">Edit</a>
        {% endif %}
      </td>
    </tr>
    {% else %}
    <tr><td colspan="8">No projects found.</td></tr>
    {% endfor %}
    </tbody>
  </table>
</section>
{% endblock %}

