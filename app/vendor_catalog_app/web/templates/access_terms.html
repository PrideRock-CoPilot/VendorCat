{% extends "base.html" %}
{% block content %}
<section class="card section-divider terms-card">
  <div class="section-header">
    <div>
      <h1>{{ terms.title }}</h1>
      <p class="muted">
        Effective Date: <strong>{{ terms.effective_date }}</strong>
        | Version: <strong>{{ terms.version }}</strong>
      </p>
    </div>
  </div>

  <div class="flash info">
    This application is for internal proof-of-concept use only and is not approved for enterprise production data.
  </div>

  <div id="terms-scroll-box" class="terms-scroll-box" tabindex="0" aria-label="Terms and conditions scroll area">
    {% for section in terms.sections %}
    <p>{{ section }}</p>
    {% endfor %}
  </div>

  {% if show_accept|default(true) %}
  <form method="post" action="/access/terms/accept" id="terms-accept-form" class="terms-accept-form">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
    <input type="hidden" name="next" value="{{ next_path }}">
    <input type="hidden" name="terms_version" value="{{ terms.version }}">
    <label class="terms-agree-row">
      <input type="checkbox" id="agree-terms-checkbox" name="agree_terms" value="true">
      <span>I have read and agree to these terms for this version.</span>
    </label>
    <div class="button-group">
      <button type="submit" id="accept-terms-button" disabled>Accept And Continue</button>
      <a class="button-link subtle" href="/access/request">Request Access</a>
    </div>
  </form>
  {% else %}
  <div class="button-group" style="margin-top: 10px;">
    <a class="button-link subtle" href="/dashboard">Back To Dashboard</a>
  </div>
  {% endif %}
</section>
{% endblock %}

{% block scripts %}
{% if show_accept|default(true) %}
<script>
(() => {
  const agreeCheckbox = document.getElementById("agree-terms-checkbox");
  const acceptButton = document.getElementById("accept-terms-button");
  if (!agreeCheckbox || !acceptButton) {
    return;
  }

  const refresh = () => {
    acceptButton.disabled = !agreeCheckbox.checked;
  };

  agreeCheckbox.addEventListener("change", refresh);
  refresh();
})();
</script>
{% endif %}
{% endblock %}
